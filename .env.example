# =============================================================================
# MobilityOne WhatsApp Bot - Environment Configuration
# Version: 2.0 - Enterprise Dual-User Security
# =============================================================================
# Kopiraj u .env i popuni stvarnim vrijednostima!
# NIKADA ne commitaj .env u git!
# =============================================================================

# --- ENVIRONMENT ---
APP_ENV=development
DEBUG=true

# =============================================================================
# DATABASE - DUAL-USER SECURITY MODEL
# =============================================================================
# PostgreSQL superuser (used by migrations/init scripts only)
DB_PASSWORD=your-postgres-admin-password

# BOT USER (LIMITED ACCESS)
# - Can access: user_mappings, conversations, messages, tool_executions
# - Can INSERT: hallucination_reports (to record "krivo" feedback)
# - CANNOT access: audit_logs, hallucination_reports (read/update/delete)
BOT_DB_PASSWORD=your-bot-db-password
BOT_DATABASE_URL=postgresql+asyncpg://bot_user:your-bot-db-password@localhost:5432/mobility_db

# ADMIN USER (FULL ACCESS)
# - Full access to ALL tables including audit_logs, hallucination_reports
# - Used only by admin-api service
ADMIN_DB_PASSWORD=your-admin-db-password
ADMIN_DATABASE_URL=postgresql+asyncpg://admin_user:your-admin-db-password@localhost:5432/mobility_db

# Legacy (backward compatibility - will use BOT_DATABASE_URL if set)
DATABASE_URL=postgresql+asyncpg://bot_user:your-bot-db-password@localhost:5432/mobility_db

# --- CONNECTION POOLING ---
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS
# =============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your-redis-password
REDIS_MAX_CONNECTIONS=50

# =============================================================================
# INFOBIP (WhatsApp)
# =============================================================================
INFOBIP_BASE_URL=your-infobip-url.api.infobip.com
INFOBIP_API_KEY=your-infobip-api-key
INFOBIP_SENDER_NUMBER=your-sender-number
INFOBIP_SECRET_KEY=your-secret-key

# =============================================================================
# OPENAI / AZURE
# =============================================================================
# Odkomentiraj jedan od ova dva:

# OpenAI direktno:
#OPENAI_API_KEY=sk-your-api-key
#OPENAI_MODEL=gpt-4o-mini

# Azure OpenAI:
OPENAI_API_TYPE=azure
AZURE_OPENAI_ENDPOINT=https://your-instance.openai.azure.com/
AZURE_OPENAI_API_KEY=your-azure-api-key
AZURE_OPENAI_API_VERSION=2024-08-01-preview
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4o-mini
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-ada-002

AI_CONFIDENCE_THRESHOLD=0.85

# =============================================================================
# MOBILITY ONE (Backend API)
# =============================================================================
MOBILITY_API_URL=https://your-instance.mobilityone.io/
SWAGGER_URL=https://your-instance.mobilityone.io/automation/swagger/v1.0.0/swagger.json
MOBILITY_AUTH_URL=https://your-instance.mobilityone.io/sso/connect/token
MOBILITY_CLIENT_ID=your-client-id
MOBILITY_CLIENT_SECRET=your-client-secret
MOBILITY_TENANT_ID=your-tenant-uuid

# =============================================================================
# MONITORING
# =============================================================================
GRAFANA_PASSWORD=your-grafana-password
SENTRY_DSN=your-sentry-dsn

# =============================================================================
# ADMIN API (Feedback Loop Dashboard)
# =============================================================================
# Generiraj tokene s: openssl rand -hex 32
ADMIN_TOKEN_1=generate-64-char-hex-token
ADMIN_TOKEN_1_USER=admin.username
ADMIN_TOKEN_2=generate-another-64-char-hex-token
ADMIN_TOKEN_2_USER=another.admin

# IP Whitelist (CIDR format)
ADMIN_ALLOWED_IPS=10.0.0.0/8,192.168.0.0/16

# Rate limiting
ADMIN_RATE_LIMIT_PER_MINUTE=30

# =============================================================================
# PRODUCTION ONLY
# =============================================================================
ACME_EMAIL=admin@yourdomain.com
WORKER_REPLICAS=2

# =============================================================================
# SECURITY NOTE
# =============================================================================
# U produkciji, koristi jake lozinke (min 32 znaka):
# openssl rand -base64 32
#
# DUAL-USER SIGURNOST:
# Bot API koristi bot_user koji NEMA pristup admin tablicama.
# Ako bot bude kompromitiran kroz prompt injection,
# napadač NE MOŽE pristupiti audit logovima ili hallucination reports!
# =============================================================================
