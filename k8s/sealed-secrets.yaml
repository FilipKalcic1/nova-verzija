# =============================================================================
# SEALED SECRETS - GitOps-Safe Secret Management
# =============================================================================
#
# Sealed Secrets encrypts your secrets so they can be safely committed to Git.
# The controller running in your cluster is the only thing that can decrypt them.
#
# SETUP:
# 1. Install Sealed Secrets controller:
#    helm repo add sealed-secrets https://bitnami-labs.github.io/sealed-secrets
#    helm install sealed-secrets sealed-secrets/sealed-secrets -n kube-system
#
# 2. Install kubeseal CLI:
#    # macOS
#    brew install kubeseal
#
#    # Linux
#    curl -L https://github.com/bitnami-labs/sealed-secrets/releases/download/v0.24.0/kubeseal-linux-amd64 -o kubeseal
#    chmod +x kubeseal && sudo mv kubeseal /usr/local/bin/
#
# 3. Create your plain secret (DO NOT commit this!):
#    kubectl create secret generic mobility-secrets \
#      --namespace=mobility \
#      --from-literal=DATABASE_URL="postgresql+asyncpg://bot_user:PASSWORD@postgres:5432/mobility_db" \
#      --from-literal=REDIS_URL="redis://redis:6379/0" \
#      --from-literal=AZURE_OPENAI_API_KEY="your-key" \
#      --from-literal=AZURE_OPENAI_ENDPOINT="https://your-instance.openai.azure.com" \
#      --from-literal=MOBILITY_CLIENT_ID="your-client-id" \
#      --from-literal=MOBILITY_CLIENT_SECRET="your-client-secret" \
#      --from-literal=MOBILITY_TENANT_ID="your-tenant-id" \
#      --from-literal=MOBILITY_API_URL="https://your-instance.mobilityone.io" \
#      --from-literal=MOBILITY_AUTH_URL="https://your-instance.mobilityone.io/sso/connect/token" \
#      --from-literal=INFOBIP_API_KEY="your-infobip-key" \
#      --from-literal=INFOBIP_SECRET_KEY="your-webhook-secret" \
#      --from-literal=WHATSAPP_VERIFY_TOKEN="your-verify-token" \
#      --from-literal=ADMIN_TOKEN_1="your-64-char-hex-token" \
#      --from-literal=ADMIN_TOKEN_1_USER="admin.user" \
#      --dry-run=client -o yaml > plain-secret.yaml
#
# 4. Seal the secret:
#    kubeseal --format yaml < plain-secret.yaml > k8s/sealed-secrets.yaml
#
# 5. Delete the plain secret file:
#    rm plain-secret.yaml
#
# 6. Apply the sealed secret:
#    kubectl apply -f k8s/sealed-secrets.yaml
#
# =============================================================================
# EXAMPLE SEALED SECRET (PLACEHOLDER - Replace with your actual sealed secret)
# =============================================================================
#
# The structure below shows what a SealedSecret looks like.
# You MUST generate your own using kubeseal - these values are just examples!
#
# apiVersion: bitnami.com/v1alpha1
# kind: SealedSecret
# metadata:
#   name: mobility-secrets
#   namespace: mobility
# spec:
#   encryptedData:
#     DATABASE_URL: AgBw5G8h... (encrypted base64)
#     REDIS_URL: AgAx7K2p... (encrypted base64)
#     AZURE_OPENAI_API_KEY: AgCz3M9q... (encrypted base64)
#     ... more encrypted fields
#   template:
#     metadata:
#       name: mobility-secrets
#       namespace: mobility
#     type: Opaque
#
# =============================================================================
# ALTERNATIVE: External Secrets Operator
# =============================================================================
#
# If you use AWS Secrets Manager, Azure Key Vault, or HashiCorp Vault,
# consider External Secrets Operator instead:
#
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: mobility-secrets
#   namespace: mobility
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     name: azure-keyvault  # or aws-secrets-manager, hashicorp-vault
#     kind: ClusterSecretStore
#   target:
#     name: mobility-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: DATABASE_URL
#       remoteRef:
#         key: mobility-bot/database-url
#     - secretKey: AZURE_OPENAI_API_KEY
#       remoteRef:
#         key: mobility-bot/azure-openai-key
#     # ... more mappings
#
# =============================================================================
# QUICK START SCRIPT
# =============================================================================
#
# Save this as create-sealed-secret.sh and run it:
#
# #!/bin/bash
# set -e
#
# NAMESPACE="mobility"
#
# # Create namespace if not exists
# kubectl create namespace $NAMESPACE --dry-run=client -o yaml | kubectl apply -f -
#
# # Create the secret (you'll be prompted for values)
# echo "Enter DATABASE_URL:"
# read -s DATABASE_URL
# echo "Enter REDIS_URL:"
# read -s REDIS_URL
# echo "Enter AZURE_OPENAI_API_KEY:"
# read -s AZURE_OPENAI_API_KEY
# # ... more prompts
#
# kubectl create secret generic mobility-secrets \
#   --namespace=$NAMESPACE \
#   --from-literal=DATABASE_URL="$DATABASE_URL" \
#   --from-literal=REDIS_URL="$REDIS_URL" \
#   --from-literal=AZURE_OPENAI_API_KEY="$AZURE_OPENAI_API_KEY" \
#   --dry-run=client -o yaml | kubeseal --format yaml > sealed-secrets.yaml
#
# echo "Sealed secret created. Apply with: kubectl apply -f sealed-secrets.yaml"
#
# =============================================================================
